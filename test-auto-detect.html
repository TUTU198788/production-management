<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Excelè‡ªåŠ¨è¯†åˆ«å‹å·åŠŸèƒ½æµ‹è¯•</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            margin: 0;
            padding: 20px;
            background: #f8fafc;
            color: #1f2937;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            padding: 30px;
        }
        
        h1 {
            color: #1e40af;
            margin-bottom: 30px;
            text-align: center;
        }
        
        .test-section {
            margin-bottom: 40px;
            padding: 20px;
            border: 1px solid #e5e7eb;
            border-radius: 8px;
        }
        
        .test-section h3 {
            color: #059669;
            margin-top: 0;
        }
        
        .test-data {
            background: #f3f4f6;
            padding: 15px;
            border-radius: 6px;
            margin: 15px 0;
        }
        
        .test-data pre {
            margin: 0;
            font-size: 14px;
            overflow-x: auto;
        }
        
        .expected-result {
            background: #ecfdf5;
            border: 1px solid #10b981;
            padding: 15px;
            border-radius: 6px;
            margin: 15px 0;
        }
        
        .expected-result h4 {
            color: #059669;
            margin-top: 0;
        }
        
        .test-button {
            background: #3b82f6;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 16px;
            margin: 10px 5px;
        }
        
        .test-button:hover {
            background: #2563eb;
        }
        
        .result-area {
            margin-top: 20px;
            padding: 20px;
            background: #f9fafb;
            border-radius: 8px;
            border: 1px solid #d1d5db;
        }
        
        .success {
            color: #059669;
            background: #ecfdf5;
            border-color: #10b981;
        }
        
        .error {
            color: #dc2626;
            background: #fef2f2;
            border-color: #f87171;
        }
        
        .spec-card {
            display: inline-block;
            margin: 5px;
            padding: 10px 15px;
            background: white;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);
        }
        
        .spec-card.h100 {
            border-left: 4px solid #3b82f6;
        }
        
        .spec-card.h80 {
            border-left: 4px solid #10b981;
        }
        
        .spec-card.h120 {
            border-left: 4px solid #f59e0b;
        }
        
        .spec-title {
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .spec-details {
            font-size: 12px;
            color: #6b7280;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ“Š Excelè‡ªåŠ¨è¯†åˆ«å‹å·åŠŸèƒ½æµ‹è¯•</h1>
        
        <div class="test-section">
            <h3>ğŸ¯ åŠŸèƒ½è¯´æ˜</h3>
            <p>æ–°çš„Excelå¯¼å…¥åŠŸèƒ½æ”¯æŒè‡ªåŠ¨è¯†åˆ«è¡¨æ ¼ä¸­çš„å‹å·ä¿¡æ¯ï¼š</p>
            <ul>
                <li>âœ… <strong>è‡ªåŠ¨è¯†åˆ«å®Œæ•´è§„æ ¼</strong>ï¼šå¦‚ H100-1400mmã€H80-800mm</li>
                <li>âœ… <strong>è‡ªåŠ¨è¯†åˆ«å•ç‹¬å‹å·</strong>ï¼šå¦‚ H100ã€H80ã€H120</li>
                <li>âœ… <strong>æ™ºèƒ½è§£æé•¿åº¦</strong>ï¼šä»æ•°å€¼åˆ—ä¸­è¯†åˆ«é•¿åº¦ä¿¡æ¯</li>
                <li>âœ… <strong>çµæ´»æ•°é‡è¯†åˆ«</strong>ï¼šè‡ªåŠ¨è¯†åˆ«æ•°é‡åˆ—</li>
                <li>âœ… <strong>å‹å·é€‰æ‹©å¯é€‰</strong>ï¼šå¯ä»¥ä¸é€‰æ‹©å‹å·ï¼Œå®Œå…¨ä¾èµ–è‡ªåŠ¨è¯†åˆ«</li>
            </ul>
        </div>

        <div class="test-section">
            <h3>ğŸ“‹ æµ‹è¯•æ•°æ®æ ¼å¼</h3>
            
            <h4>æ ¼å¼1ï¼šå®Œæ•´è§„æ ¼æ ¼å¼</h4>
            <div class="test-data">
                <pre>åºå· | è§„æ ¼å‹å·      | æ•°é‡
1    | H100-1400mm  | 50
2    | H80-800mm    | 30
3    | H120-1600mm  | 25</pre>
            </div>
            
            <h4>æ ¼å¼2ï¼šåˆ†ç¦»å‹å·æ ¼å¼</h4>
            <div class="test-data">
                <pre>åºå· | å‹å·  | é•¿åº¦  | æ•°é‡
1    | H100  | 1400  | 50
2    | H80   | 800   | 30
3    | H120  | 1600  | 25</pre>
            </div>
            
            <h4>æ ¼å¼3ï¼šæ··åˆæ ¼å¼</h4>
            <div class="test-data">
                <pre>åºå· | è§„æ ¼/å‹å·     | é•¿åº¦  | æ•°é‡
1    | H100-1400mm  |       | 50
2    | H80          | 800   | 30
3    | H120-1600mm  |       | 25</pre>
            </div>
        </div>

        <div class="test-section">
            <h3>ğŸ§ª æ¨¡æ‹Ÿæµ‹è¯•</h3>
            <p>ç‚¹å‡»ä¸‹é¢çš„æŒ‰é’®æµ‹è¯•ä¸åŒæ ¼å¼çš„æ•°æ®è§£æï¼š</p>
            
            <button class="test-button" onclick="testCompleteSpec()">æµ‹è¯•å®Œæ•´è§„æ ¼æ ¼å¼</button>
            <button class="test-button" onclick="testSeparateFormat()">æµ‹è¯•åˆ†ç¦»å‹å·æ ¼å¼</button>
            <button class="test-button" onclick="testMixedFormat()">æµ‹è¯•æ··åˆæ ¼å¼</button>
            <button class="test-button" onclick="testErrorHandling()">æµ‹è¯•é”™è¯¯å¤„ç†</button>
            
            <div id="testResults" class="result-area" style="display: none;">
                <h4>æµ‹è¯•ç»“æœ</h4>
                <div id="resultContent"></div>
            </div>
        </div>

        <div class="test-section">
            <h3>âœ… é¢„æœŸæ•ˆæœ</h3>
            <div class="expected-result">
                <h4>è‡ªåŠ¨è¯†åˆ«ç»“æœç¤ºä¾‹ï¼š</h4>
                <div class="spec-card h100">
                    <div class="spec-title">H100-1400mm</div>
                    <div class="spec-details">50æ ¹ (å¾…ç”Ÿäº§) | è‡ªåŠ¨è¯†åˆ«å‹å·: H100</div>
                </div>
                <div class="spec-card h80">
                    <div class="spec-title">H80-800mm</div>
                    <div class="spec-details">30æ ¹ (å¾…ç”Ÿäº§) | è‡ªåŠ¨è¯†åˆ«å‹å·: H80</div>
                </div>
                <div class="spec-card h120">
                    <div class="spec-title">H120-1600mm</div>
                    <div class="spec-details">25æ ¹ (å¾…ç”Ÿäº§) | è‡ªåŠ¨è¯†åˆ«å‹å·: H120</div>
                </div>
            </div>
        </div>

        <div class="test-section">
            <h3>ğŸ”§ ä½¿ç”¨æ–¹æ³•</h3>
            <ol>
                <li><strong>æ‰“å¼€Excelå¯¼å…¥å¯¹è¯æ¡†</strong></li>
                <li><strong>é€‰æ‹©å·¥åœ°åŒºåŸŸ</strong>ï¼ˆå¿…é€‰ï¼‰</li>
                <li><strong>å‹å·é€‰æ‹©</strong>ï¼š
                    <ul>
                        <li>é€‰æ‹©"è‡ªåŠ¨è¯†åˆ«å‹å·"ï¼ˆæ¨èï¼‰</li>
                        <li>æˆ–é€‰æ‹©å…·ä½“å‹å·å¼ºåˆ¶ä½¿ç”¨</li>
                    </ul>
                </li>
                <li><strong>é€‰æ‹©Excelæ–‡ä»¶</strong></li>
                <li><strong>é¢„è§ˆæ•°æ®</strong>ï¼šæ£€æŸ¥è‡ªåŠ¨è¯†åˆ«ç»“æœ</li>
                <li><strong>ç¡®è®¤å¯¼å…¥</strong></li>
            </ol>
        </div>
    </div>

    <script>
        // æ¨¡æ‹Ÿè‡ªåŠ¨è¯†åˆ«åŠŸèƒ½çš„æµ‹è¯•å‡½æ•°
        function testCompleteSpec() {
            const testData = [
                ['åºå·', 'è§„æ ¼å‹å·', 'æ•°é‡'],
                [1, 'H100-1400mm', 50],
                [2, 'H80-800mm', 30],
                [3, 'H120-1600mm', 25]
            ];
            
            const results = simulateAutoDetection(testData);
            showTestResults('å®Œæ•´è§„æ ¼æ ¼å¼æµ‹è¯•', results, true);
        }
        
        function testSeparateFormat() {
            const testData = [
                ['åºå·', 'å‹å·', 'é•¿åº¦', 'æ•°é‡'],
                [1, 'H100', 1400, 50],
                [2, 'H80', 800, 30],
                [3, 'H120', 1600, 25]
            ];
            
            const results = simulateAutoDetection(testData);
            showTestResults('åˆ†ç¦»å‹å·æ ¼å¼æµ‹è¯•', results, true);
        }
        
        function testMixedFormat() {
            const testData = [
                ['åºå·', 'è§„æ ¼/å‹å·', 'é•¿åº¦', 'æ•°é‡'],
                [1, 'H100-1400mm', '', 50],
                [2, 'H80', 800, 30],
                [3, 'H120-1600mm', '', 25]
            ];
            
            const results = simulateAutoDetection(testData);
            showTestResults('æ··åˆæ ¼å¼æµ‹è¯•', results, true);
        }
        
        function testErrorHandling() {
            const testData = [
                ['åºå·', 'æè¿°', 'å…¶ä»–', 'å¤‡æ³¨'],
                [1, 'æ— æ•ˆæ•°æ®', 'test', 'æµ‹è¯•'],
                [2, '', '', ''],
                [3, 'H100', '', ''] // ç¼ºå°‘æ•°é‡
            ];
            
            const results = simulateAutoDetection(testData);
            showTestResults('é”™è¯¯å¤„ç†æµ‹è¯•', results, false);
        }
        
        function simulateAutoDetection(testData) {
            const results = [];
            const errors = [];
            
            // è·³è¿‡æ ‡é¢˜è¡Œï¼Œä»ç¬¬äºŒè¡Œå¼€å§‹è§£æ
            for (let i = 1; i < testData.length; i++) {
                const row = testData[i];
                let spec = null;
                let quantity = null;
                let detectedType = null;
                
                // æ‰«ææ¯ä¸€åˆ—å¯»æ‰¾è§„æ ¼å’Œå‹å·ä¿¡æ¯
                for (let j = 0; j < row.length; j++) {
                    const cell = String(row[j]).trim();
                    
                    // æ£€æŸ¥å®Œæ•´è§„æ ¼
                    const fullSpecMatch = cell.match(/^(H\d+)-?(\d+)mm?$/i);
                    if (fullSpecMatch) {
                        detectedType = fullSpecMatch[1].toUpperCase();
                        const length = parseInt(fullSpecMatch[2]);
                        spec = `${detectedType}-${length}mm`;
                        break;
                    }
                    
                    // æ£€æŸ¥å•ç‹¬å‹å·
                    const typeMatch = cell.match(/^H(\d+)$/i);
                    if (typeMatch) {
                        detectedType = cell.toUpperCase();
                    }
                }
                
                // å¦‚æœæ²¡æœ‰å®Œæ•´è§„æ ¼ï¼Œå°è¯•ç»„åˆå‹å·å’Œé•¿åº¦
                if (!spec && detectedType) {
                    for (let j = 0; j < row.length; j++) {
                        const num = parseInt(row[j]);
                        if (num >= 200 && num <= 11800 && num % 200 === 0) {
                            spec = `${detectedType}-${num}mm`;
                            break;
                        }
                    }
                }
                
                // å¯»æ‰¾æ•°é‡
                for (let j = 0; j < row.length; j++) {
                    const num = parseInt(row[j]);
                    if (num > 0 && num < 100000 && !String(row[j]).includes('mm')) {
                        quantity = num;
                        break;
                    }
                }
                
                if (spec && quantity) {
                    results.push({
                        spec: spec,
                        quantity: quantity,
                        detectedType: detectedType,
                        rowIndex: i + 1
                    });
                } else {
                    const missing = [];
                    if (!spec) missing.push('è§„æ ¼/å‹å·');
                    if (!quantity) missing.push('æ•°é‡');
                    errors.push(`ç¬¬${i + 1}è¡Œ: æ— æ³•è¯†åˆ«${missing.join('å’Œ')}`);
                }
            }
            
            return { results, errors };
        }
        
        function showTestResults(testName, data, isSuccess) {
            const resultsDiv = document.getElementById('testResults');
            const contentDiv = document.getElementById('resultContent');
            
            let html = `<h5>${testName}</h5>`;
            
            if (data.results.length > 0) {
                html += '<div style="margin: 15px 0;"><strong>âœ… æˆåŠŸè¯†åˆ«çš„æ•°æ®ï¼š</strong></div>';
                data.results.forEach(item => {
                    const typeClass = item.detectedType.toLowerCase();
                    html += `
                        <div class="spec-card ${typeClass}">
                            <div class="spec-title">${item.spec}</div>
                            <div class="spec-details">${item.quantity}æ ¹ | ç¬¬${item.rowIndex}è¡Œ | è¯†åˆ«å‹å·: ${item.detectedType}</div>
                        </div>
                    `;
                });
            }
            
            if (data.errors.length > 0) {
                html += '<div style="margin: 15px 0;"><strong>âŒ è¯†åˆ«å¤±è´¥çš„è¡Œï¼š</strong></div>';
                html += '<ul>';
                data.errors.forEach(error => {
                    html += `<li style="color: #dc2626;">${error}</li>`;
                });
                html += '</ul>';
            }
            
            if (data.results.length === 0 && data.errors.length === 0) {
                html += '<div style="color: #6b7280;">æ²¡æœ‰æ‰¾åˆ°å¯è¯†åˆ«çš„æ•°æ®</div>';
            }
            
            contentDiv.innerHTML = html;
            resultsDiv.style.display = 'block';
            resultsDiv.className = `result-area ${isSuccess && data.results.length > 0 ? 'success' : 'error'}`;
        }
    </script>
</body>
</html>
